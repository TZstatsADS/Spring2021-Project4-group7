---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 
```{r load data}
lowDim <- read_csv('../data/lowDim_dataset.csv')
highDim <- read_csv('../data/highDim_dataset.csv') 
```

```{r prep data reg estimate}
df_ld <- lowDim %>% mutate(A = factor(A))
df_hd <- highDim %>% mutate(A = factor(A))
```

```{r}
X_low <- df_ld %>% select(-Y, -A) %>% as.matrix
A_low <- df_ld %>% select(A) %>% as.matrix
cv_L2 <- cv.glmnet(X_low, A_low, family = "binomial", alpha = 0)
```

```{r}
L2_low <- glmnet(X_low, A_low, family = "binomial",
                 alpha = 0, lambda = cv_L2$lambda.min)
propensity_score_low <- predict(L2_low, X_low, type = "response")

```
Here I calculate the weights:

```{r}
T <- as.numeric(A_low)
wt_low <- T/(propensity_score_low) + (1-T)/(1-propensity_score_low)
